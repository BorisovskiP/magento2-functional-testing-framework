<?php
namespace Magento\AcceptanceTest\_default\Backend;

use Magento\FunctionalTestingFramework\AcceptanceTester;
use \Codeception\Util\Locator;
use Yandex\Allure\Adapter\Annotation\Features;
use Yandex\Allure\Adapter\Annotation\Stories;
use Yandex\Allure\Adapter\Annotation\Title;
use Yandex\Allure\Adapter\Annotation\Description;
use Yandex\Allure\Adapter\Annotation\Parameter;
use Yandex\Allure\Adapter\Annotation\Severity;
use Yandex\Allure\Adapter\Model\SeverityLevel;
use Yandex\Allure\Adapter\Annotation\TestCaseId;

/**
 * @Description("<br><br><b><font size=+0.9>Test files</font></b><br><br>verification/TestModule/Test/PersistenceCustomFieldsTest.xml<br>")
 */
class PersistenceCustomFieldsTestCest
{
	/**
	  * @param AcceptanceTester $I
	  * @throws \Exception
	  */
	public function _before(AcceptanceTester $I)
	{
		$createData1Fields['firstname'] = "Mac";
		$createData1Fields['lastname'] = "Doe";
		$I->comment("[createData1] create 'DefaultPerson' entity");
		$I->createEntity(
			"createData1",
			"hook",
			"DefaultPerson",
			[],
			$createData1Fields
		);

		$createData2Fields['firstname'] = $I->retrieveEntityField('createData1', 'firstname', 'hook');
		$I->comment("[createData2] create 'uniqueData' entity");
		$I->createEntity(
			"createData2",
			"hook",
			"uniqueData",
			["createData1"],
			$createData2Fields
		);

	}

	/**
	 * @Features({"TestModule"})
	 * @Parameter(name = "AcceptanceTester", value="$I")
	 * @param AcceptanceTester $I
	 * @return void
	 * @throws \Exception
	 */
	public function PersistenceCustomFieldsTest(AcceptanceTester $I)
	{
		$createdDataFields['favoriteIndex'] = "1";
		$createdDataFields['middlename'] = "Kovacs";
		$I->comment("[createdData] create 'simpleData' entity");
		$I->createEntity(
			"createdData",
			"test",
			"simpleData",
			[],
			$createdDataFields
		);

		$createdData3Fields['firstname'] = "Takeshi";
		$createdData3Fields['lastname'] = "Kovacs";
		$I->comment("[createdData3] create 'UniquePerson' entity");
		$I->createEntity(
			"createdData3",
			"test",
			"UniquePerson",
			["createdData"],
			$createdData3Fields
		);

		$I->comment("Entering Action Group [createdAG] PersistenceActionGroup");
		$createDataAG1CreatedAGFields['firstname'] = "string1";
		$I->comment("[createDataAG1CreatedAG] create 'simpleData' entity");
		$I->createEntity(
			"createDataAG1CreatedAG",
			"test",
			"simpleData",
			[],
			$createDataAG1CreatedAGFields
		);

		$createDataAG2CreatedAGFields['firstname'] = "Jane";
		$I->comment("[createDataAG2CreatedAG] create 'simpleData' entity");
		$I->createEntity(
			"createDataAG2CreatedAG",
			"test",
			"simpleData",
			[],
			$createDataAG2CreatedAGFields
		);

		$createDataAG3CreatedAGFields['firstname'] = $I->retrieveEntityField('createdData3', 'firstname', 'test');
		$I->comment("[createDataAG3CreatedAG] create 'simpleData' entity");
		$I->createEntity(
			"createDataAG3CreatedAG",
			"test",
			"simpleData",
			[],
			$createDataAG3CreatedAGFields
		);

		$I->comment("Exiting Action Group [createdAG] PersistenceActionGroup");
		$I->comment("Entering Action Group [AGKEY] DataPersistenceSelfReferenceActionGroup");
		$I->comment("[createData1AGKEY] create 'entity1' entity");
		$I->createEntity(
			"createData1AGKEY",
			"test",
			"entity1",
			[],
			[]
		);

		$I->comment("[createData2AGKEY] create 'entity2' entity");
		$I->createEntity(
			"createData2AGKEY",
			"test",
			"entity2",
			[],
			[]
		);

		$createData3AGKEYFields['key1'] = $I->retrieveEntityField('createData1AGKEY', 'field', 'test');
		$createData3AGKEYFields['key2'] = $I->retrieveEntityField('createData2AGKEY', 'field', 'test');
		$I->comment("[createData3AGKEY] create 'entity3' entity");
		$I->createEntity(
			"createData3AGKEY",
			"test",
			"entity3",
			[],
			$createData3AGKEYFields
		);

		$I->comment("Exiting Action Group [AGKEY] DataPersistenceSelfReferenceActionGroup");
	}
}
